## 执行流程
### 1.根据配置文件创建SQLSessionFactory
* 解析器和MappendStatement
![](http://yingxs.com/img/mybatis-source1.png)
* Configuration对象
![](http://yingxs.com/img/mybatis-source2.png)
* mappendStatements 一个方法对应一个mappendStatement(增删改查标签)
* mapperRegistry 一个mapper对应一个代理实现类
![](http://yingxs.com/img/mybatis-source3.png)
* 总结
![](http://yingxs.com/img/mybatis-source4.png)

### 2.openSession获取SqlSession对象
> 返回SqlSession的实现类DefaultSqlSession对象。里面包含了Executor和Configuration；Executor会在这一步被创建

![](http://yingxs.com/img/mybatis-source5.png)
### 3.获取接口的代理对象
![](http://yingxs.com/img/mybatis-source6.png)

### 4.查询流程
![](http://yingxs.com/img/mybatis-source7.png)

* 总结
	* StatementHandler：处理sql语句预编译，设置参数等相关工作；
	* ParameterHandler：设置预编译参数用的
	* ResultHandler：处理结果集
	* TypeHandler：在整个过程中，进行数据库类型和javaBean类型的映射

![](http://yingxs.com/img/mybatis-source8.png)


### 整体运行流程总结
1. 根据全局配置文件(全局配置文件和sql映射文件)初始化出Configuration对象
2. 创建一个DefaultSqlSession对象，它里面包含Configuration以及Executor(根据全局配置文件中的defaultExecutorType创建出Executor)
3. DefaultSqlSession.getMapper():拿到Mapper接口对应的MapperProxy
4. MapperProxy里面有DefaultSqlSession
5. 执行增删改查方法：
	1. 调用DefaultSqlSession的增删改查方法
	2. 会创建出一个StatemeterHandler，同时也会创建ParamterHandler和ResultSetHandler
	3. 调用StatementHandler预编译参数以及设置参数值；使用ParamterHandler给sql设置参数
	4. 调用StatementHandler的增删改查方法
	5. ResultSetHandler封装结果


注意：
* 四大对象创建的时候都会有 interceptorChain.pluginAll()